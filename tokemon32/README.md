# tokemon32
*The Toke Monitor*

## wat

tokemon32 is a """potentially unwanted program""" that performs a very simple
operation. When you click the mouse the first time, a sample from Dr. Dre's "The
Next Episode" plays-- in particular, near the end of the song when he says "Hey
Hey Hey Hey." When you click the mouse a second time, it says "smoke weed every
day." Then the process sleeps for up to potentially 4 hours.

## usage

Just remotely executing the executable on the target system is sufficient. For
more advanced usage (e.g., injecting just the DLL portion of the payload), well,
keep reading I guess.

## the way it works

tokemon32 is basically a stupid virus from the 90s in the sense that it just
installs itself to HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run. Super
easy to get rid of. It wasn't built to be stealth, *but* if you want the malware
to work on systems with whitelisting, you can recompile the hook DLL to be an
injectable DLL. Just read the source and recompile where necessary!

tokemon32 is basically a wrapper for the DLL hook-- all it's responsible for is
infecting the system and making sure The Good Doctor is telling you what you
should do on a daily basis. The magic is in tokemon32-hook.
   
tokemon32-hook installs a hook on the user's system via SetWindowsHookEx (lol).
This is effectively system-wide DLL injection due to the way the function works,
hence why this part was compiled as a DLL. In a standard configuration, the
infectious application spawns the hook thread inside the DLL.

If you would like to simply use the hook, however, all you need to do is make sure
the flag INJECTABLEWEED is defined in tokemon32-hook. This way, the DLL is able to
be used as an injection payload via e.g. PowerSploit's Invoke-DllInjection.

## modification

The source is included if you feel inspired to make modifications. Go hog wild! 

In the inevitable event that these get signatures, they should be able to pack
nicely-- though you will have to build from source if you're to pack the hook DLL
and use the infection executable.